# 项目运行指南

## ✅ 项目状态检查

项目已经可以运行！但需要先完成以下准备工作。

## 📋 前置要求

在运行项目之前，请确保已安装以下软件：

1. **JDK 1.8+** - Java开发环境
2. **Maven 3.6+** - Java项目构建工具
3. **Node.js 16+** - JavaScript运行环境
4. **MySQL 8.0+** - 数据库

### 检查环境

打开命令行（PowerShell或CMD），执行以下命令检查：

```bash
java -version    # 应该显示Java版本
mvn -version     # 应该显示Maven版本
node -v          # 应该显示Node.js版本
npm -v           # 应该显示npm版本
mysql --version  # 应该显示MySQL版本
```

如果某个命令提示"不是内部或外部命令"，说明该软件未安装或未配置环境变量。

## 🚀 运行步骤

### 第一步：配置数据库

1. **启动MySQL服务**
   - Windows: 在服务管理器中启动MySQL服务，或使用命令行：
     ```bash
     net start MySQL
     ```
   - Mac/Linux: 
     ```bash
     sudo systemctl start mysql
     ```

2. **创建数据库**
   
   打开MySQL客户端（命令行或图形化工具），执行：
   
   ```sql
   CREATE DATABASE express_cabinet DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
   ```

3. **导入初始化数据**
   
   **方式一：命令行导入**
   ```bash
   mysql -u root -p express_cabinet < database/init.sql
   ```
   
   **方式二：使用MySQL客户端**
   - 打开MySQL Workbench、Navicat或其他MySQL客户端
   - 连接到MySQL服务器
   - 选择数据库 `express_cabinet`
   - 打开并执行 `database/init.sql` 文件

4. **修改数据库配置**（如果需要）
   
   编辑 `backend/src/main/resources/application.yml` 文件：
   
   ```yaml
   spring:
     datasource:
       username: root        # 改为你的MySQL用户名
       password: root        # 改为你的MySQL密码
   ```

### 第二步：启动后端服务

1. **打开命令行，进入后端目录**
   ```bash
   cd backend
   ```

2. **首次运行需要下载依赖**（会自动执行）
   ```bash
   mvn clean install
   ```
   
   这个过程可能需要几分钟，Maven会下载所有依赖包。

3. **启动后端服务**
   ```bash
   mvn spring-boot:run
   ```

4. **验证后端启动成功**
   
   看到类似以下输出说明启动成功：
   ```
   Started ExpressCabinetApplication in X.XXX seconds
   ```
   
   或者打开浏览器访问：http://localhost:8080/api/cabinets
   
   如果看到JSON响应（可能是空数组 `[]`），说明后端运行正常。

### 第三步：启动前端服务

**⚠️ 注意：保持后端服务运行，打开新的命令行窗口！**

1. **打开新的命令行窗口，进入前端目录**
   ```bash
   cd frontend
   ```

2. **安装依赖**（首次运行需要）
   ```bash
   npm install
   ```
   
   如果下载速度慢，可以使用国内镜像：
   ```bash
   npm install --registry=https://registry.npmmirror.com
   ```

3. **启动前端开发服务器**
   ```bash
   npm run dev
   ```

4. **访问应用**
   
   看到类似以下输出：
   ```
   VITE v4.x.x  ready in xxx ms
   
   ➜  Local:   http://localhost:3000/
   ```
   
   打开浏览器访问：**http://localhost:3000**

### 第四步：登录系统

使用以下测试账号登录：

- **用户名**: `admin`
- **密码**: `123456`

## 📝 快速运行命令总结

### Windows PowerShell

```powershell
# 1. 启动后端（在backend目录）
cd backend
mvn spring-boot:run

# 2. 启动前端（在新窗口，frontend目录）
cd frontend
npm install
npm run dev
```

### Mac/Linux Terminal

```bash
# 1. 启动后端（在backend目录）
cd backend
mvn spring-boot:run

# 2. 启动前端（在新终端，frontend目录）
cd frontend
npm install
npm run dev
```

## ❗ 常见问题解决

### 问题1：后端启动失败 - 端口被占用

**错误信息**: `Port 8080 is already in use`

**解决方法**:
- 修改 `backend/src/main/resources/application.yml` 中的端口：
  ```yaml
  server:
    port: 8081  # 改为其他端口
  ```
- 或者关闭占用8080端口的程序

### 问题2：数据库连接失败

**错误信息**: `Communications link failure` 或 `Access denied`

**解决方法**:
1. 检查MySQL服务是否启动
2. 检查 `application.yml` 中的数据库用户名密码是否正确
3. 检查数据库是否已创建
4. 检查MySQL是否允许本地连接

### 问题3：前端npm install失败

**错误信息**: `npm ERR!` 相关错误

**解决方法**:
1. 检查网络连接
2. 使用国内镜像：
   ```bash
   npm install --registry=https://registry.npmmirror.com
   ```
3. 删除 `node_modules` 文件夹后重新安装：
   ```bash
   rm -rf node_modules  # Mac/Linux
   rmdir /s node_modules  # Windows
   npm install
   ```

### 问题4：前端无法连接后端

**错误信息**: `Network Error` 或 `CORS error`

**解决方法**:
1. 确保后端服务正在运行（访问 http://localhost:8080/api/cabinets 测试）
2. 检查 `frontend/vite.config.js` 中的代理配置
3. 确保后端端口与配置一致

### 问题5：Maven下载依赖很慢

**解决方法**:
配置Maven使用国内镜像，编辑 `~/.m2/settings.xml`（如果没有则创建）：

```xml
<settings>
  <mirrors>
    <mirror>
      <id>aliyun</id>
      <mirrorOf>central</mirrorOf>
      <url>https://maven.aliyun.com/repository/public</url>
    </mirror>
  </mirrors>
</settings>
```

## 🎯 验证项目运行成功

如果一切正常，你应该能够：

1. ✅ 访问 http://localhost:3000 看到登录页面
2. ✅ 使用 `admin/123456` 成功登录
3. ✅ 看到仪表盘页面，显示统计数据
4. ✅ 在"快递柜管理"页面看到快递柜列表
5. ✅ 在"订单管理"页面看到订单列表

## 📞 需要帮助？

如果遇到其他问题，请检查：

1. 所有环境变量是否正确配置
2. 数据库是否正常运行
3. 端口是否被占用
4. 防火墙是否阻止了连接
5. 查看后端和前端控制台的错误信息

祝运行顺利！🎉

