# 工作日志

## 1月12日-14日 听课培训

## 1月15日 环境配置

### 上午
- 搭建开发环境：安装微信开发者工具、Node.js等必要工具
- 配置项目目录结构：创建user_xcx目录和相关文件结构
- 初始化小程序项目：配置app.json、app.js等基础文件

### 下午
- 配置后端服务连接：设置API请求地址和网络请求封装
- 测试数据库连接：验证MySQL服务是否正常运行
- 初始化项目依赖：检查并配置必要的开发依赖

启动后端：
cd "e:\professional_design\project3\Professional-comprehensive-design\server\backend" ; .\mvnw.cmd spring-boot:run

## 1月16日 项目开发

### 上午
- **项目分工**：确定负责用户端小程序开发，主要包括用户认证、快递柜管理、存件取件等功能模块
- **架构设计**：设计小程序页面结构和导航流程
- **基础框架搭建**：
  - 创建API请求封装工具类（utils/api.js、utils/service.js）
  - 配置全局状态管理（app.js）
  - 实现页面路由配置（app.json）

### 下午
- **核心功能开发**：
  - 用户认证模块：登录页面（login）、注册页面（register）
  - 快递柜管理：快递柜列表页面（cabinets）、快递柜详情页面（cabinet-detail）
  - 存件功能：存件页面（store）
  - 取件功能：取件页面（pick-up）
  - 订单管理：订单列表页面（orders）
  - 个人中心：个人中心页面（profile）
  - 启动页面：优化启动页（index）

- **问题解决**：
  - 修复Skyline渲染器兼容性问题
  - 解决网络请求域名校验问题
  - 修复数据结构不匹配问题
  - 解决页面跳转方式错误问题

- **功能验证**：
  - 测试用户登录功能（使用测试账号admin/123456）
  - 验证快递柜列表数据加载
  - 测试API接口调用正常
  - 确认小程序可以正常运行

### 开发成果
- 完成了用户端小程序的完整开发
- 实现了所有核心功能模块
- 修复了开发过程中的各种技术问题
- 小程序可以正常运行并通过登录测试

### 技术栈使用
- 微信小程序原生开发
- JavaScript ES6+
- 模块化架构设计
- RESTful API调用
- 响应式UI设计

## 后续计划
- 完善小程序的UI设计和用户体验
- 测试所有功能模块的完整性
- 优化网络请求和页面性能
- 准备项目交付和文档整理

## 1月17日 项目开发继续

### 功能问题修复
- **快递柜列表显示问题**：
  - 问题：登录后无法查看快递柜列表
  - 原因：字段名不匹配（前端使用 name/code/address，后端返回 cabinetCode/location）
  - 修复：添加字段映射，适配前端显示

- **格口状态判断问题**：
  - 问题：所有格口显示"占用"状态
  - 原因：状态判断逻辑错误（将 status === 1 错误判定为"占用"）
  - 修复：改为使用 hasItem === 1 判定占用状态

- **可用格口数量显示问题**：
  - 问题：所有快递柜显示"可用格口：8"，与实际状态不符
  - 原因：直接使用 totalCompartments 而不是实际可用数量
  - 修复：从后端API获取实际可用格口数量

- **存件功能问题**：
  - 问题：存件失败，数据库约束异常
  - 原因：字段名不匹配（使用 expressNumber 而不是 orderNo），缺少必填字段（orderType、status）
  - 修复：修正字段名，添加必填字段

- **后端服务问题**：
  - 问题：无法连接后端服务
  - 原因：后端服务未启动
  - 修复：重启后端服务

### 功能验证
- ✅ 用户登录功能正常
- ✅ 快递柜列表显示正常
- ✅ 格口状态显示正确
- ✅ 存件功能正常（生成取件码）
- ✅ 取件功能正常（输入取件码开仓）
- ✅ 订单管理功能正常

### 技术改进
- 优化API请求封装，添加错误处理
- 完善字段映射，适配前后端数据结构
- 改进状态判断逻辑，提升用户体验
- 添加详细的功能测试指南

## 1月19日 项目开发继续

### 功能问题修复
- **订单显示问题**：修复订单页面字段映射，确保快递单号、格口等信息完整显示
- **订单创建问题**：添加receiverUserId字段设置，确保订单与用户关联
- **数据传递问题**：确保订单创建时传递完整的快递公司信息

### 技术改进
- 在ExpressOrder实体中添加compartmentNo字段，存储用户可见的格口号
- 修改ExpressOrderService订单创建逻辑，从Compartment实体获取格口号
- 优化前端字段显示逻辑，使用正确的字段名
- 提升字段显示的默认值处理，改善用户体验

### 剩余问题
- **格口号对应错误**：前端显示的格口号与实际存储的格口号不一致，需进一步测试验证(已修复)

## 1月20日 项目开发继续

### 功能完善与修复
- **tabBar导航配置**：在app.json中添加完整的底部导航栏配置，包含4个主tab（快递柜、取件、订单、我的）
- **通知闪烁问题修复**：通过setTimeout延迟3000ms执行navigateBack，解决存件后提示信息过快消失问题
- **导航方式优化**：将登录成功后的redirectTo改为switchTab，确保正确显示底部导航栏
- **API调用更新**：将取件页面的getMyOrders接口更新为getByUserId，修复订单列表不显示问题
- **UI/UX改进**：优化页面导航逻辑，确保操作流程顺畅

### 功能验证
- ✅ 底部导航栏正常显示和切换
- ✅ 存件后提示信息持久显示
- ✅ 登录成功后正确跳转并显示导航栏
- ✅ 取件页面订单列表正常加载
- ✅ 各页面API调用正常，无404错误

### 剩余问题
- 个人信息维护功能需进一步调试
- 快递柜定位功能需要后端支持
- 发快递页面需添加返回键
- 寄存功能提示窗口优化，太快就消失了

## 1月21日 项目开发继续

### 功能完善与修复
- **页面排版优化**：调整个人页面布局，合并功能模块，优化间距和对齐方式
- **导航栏配置优化**：修改app.json中的navigationStyle为custom，解决页面顶部空白问题
- **用户交互优化**：为菜单项添加点击反馈效果，提升用户体验

### 功能验证
- ✅ 个人页面排版紧凑美观
- ✅ 页面顶部空白问题已解决
- ✅ 菜单项点击反馈正常
- ✅ 各页面导航和功能正常

### 剩余问题
- 个人信息维护功能需进一步调试
- 快递柜定位功能需要后端支持
- 发快递页面需添加返回键

## 1月22-23日 项目开发继续

### 前端页面美化与交互修复
- **个人中心页 (Profile)**:
  - 重构为紧凑的卡片式布局，整合“退出登录”按钮
  - 修复导航栏样式，实现一屏无滚动展示
  - 优化视觉体验，强制覆盖全局样式以解决布局分散问题
- **寄快递页 (Send Express)**:
  - 引入标准导航栏组件，修复顶部文字遮挡及缺失返回键问题
  - 修复底部“确认提交”按钮样式及溢出不可见问题
- **取件页 (Pick-up)**:
  - 统一页面背景色为系统浅灰
  - 优化“遇到问题”功能区布局为水平排列，增加拨打客服电话功能
  - 完善扫码取件逻辑
- **快递柜相关页面 (Cabinets)**:
  - 修正列表页项目底部堆叠问题
  - 精简详情页冗余信息，合并格口显示区块
- **编辑资料页 (Edit Profile)**:
  - 修复输入框样式溢出问题，添加盒模型约束

### 功能验证
- ✅ 个人中心页面布局合理，无多余滚动
- ✅ 寄快递页面导航正常，提交按钮可见
- ✅ 取件页面交互流畅，背景统一
- ✅ 快递柜列表显示顺序正确

## 1月24日-25日 项目开发继续

### 功能修复与优化
- **订单页面优化**：
  - 修复开仓失败提示，显示具体错误信息（如"快递已超时"、"快递已被取走"）
  - 修复已取件、已过期订单仍弹出取件码窗口问题
  - 优化订单列表排序，未取件订单显示在最前面
  - 修复订单详情显示问题，确保所有字段正确显示
  - 添加订单删除功能，支持删除历史记录

- **存件功能修复**：
  - 修复存件页面空白问题，恢复导航栏和返回键
  - 优化存件成功后的用户流程，点击取消分享直接返回
  - 修复格口状态不及时更新问题，存件后自动刷新格口状态
  - 解决"Component is not found in path 'wx://not-found'"错误

- **其他功能修复**：
  - 修复取件页面人脸识别功能报错（添加loadUserOrders方法）
  - 实现地址管理功能，支持地址的增删改查
  - 优化用户交互流程，提升用户体验

### 技术改进
- 增强错误处理机制，确保API调用失败时显示具体错误信息
- 优化页面导航逻辑，确保操作流程顺畅
- 改进数据更新机制，实现页面间数据同步
- 增强代码的健壮性和容错能力

### 功能验证
- ✅ 订单页面显示完整，操作流畅
- ✅ 存件功能正常，格口状态实时更新
- ✅ 所有页面无空白或报错问题

### 剩余问题
- 地址管理功能还没搞好
- 人脸识别功能还有问题
- 我的订单里快递公司显示问题



