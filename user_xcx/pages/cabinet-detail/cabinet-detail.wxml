<navigation-bar title="快递柜详情" back="{{true}}" color="black" background="#f7f7f7"></navigation-bar>
<scroll-view class="scrollarea" scroll-y type="list" refresher-enabled="{{true}}" bindrefresherrefresh="onPullDownRefresh" refresher-triggered="{{loading}}">
  <view class="detail-container" wx:if="{{cabinet}}">
    <view class="cabinet-header">
      <view class="cabinet-name">{{cabinet.name}}</view>
      <view class="cabinet-info">
        <view class="info-row">
          <text class="label">编号：</text>
          <text class="value">{{cabinet.code}}</text>
        </view>
        <view class="info-row">
          <text class="label">地址：</text>
          <text class="value">{{cabinet.address}}</text>
        </view>
        <view class="info-row">
          <text class="label">状态：</text>
          <text class="value status-{{cabinet.status}}">{{cabinet.status === 1 ? '正常' : '维护中'}}</text>
        </view>
      </view>
    </view>

    <view class="section">
      <view class="section-header">
        <view class="section-title">格口状态</view>
        <view class="legend">
          <view class="legend-item">
            <view class="dot free"></view>
            <text>空闲</text>
          </view>
          <view class="legend-item">
            <view class="dot occupied"></view>
            <text>占用</text>
          </view>
        </view>
      </view>
      
      <view class="compartment-grid">
        <view 
          class="compartment-item status-{{item.hasItem}}" 
          wx:for="{{compartments}}" 
          wx:key="id"
          data-id="{{item.id}}"
          data-status="{{item.status}}"
          data-has-item="{{item.hasItem}}"
          bindtap="onCompartmentTap"
        >
          <view class="compartment-content">
            <view class="compartment-number">{{item.compartmentNo || item.number || index + 1}}</view>
            <view class="compartment-status">
              {{item.hasItem === 0 ? '点击存件' : '已占用'}}
            </view>
          </view>
          <view class="hover-mask" wx:if="{{item.hasItem === 0}}"></view>
        </view>
      </view>
    </view>
  </view>
</scroll-view>