<navigation-bar title="æˆ‘çš„è®¢å•" back="{{true}}" color="black" background="#f7f7f7"></navigation-bar>
<scroll-view class="scrollarea" scroll-y type="list" refresher-enabled="{{true}}" bindrefresherrefresh="onPullDownRefresh" refresher-triggered="{{loading}}">
  <view class="orders-container">
    <!-- æœç´¢æ¡† -->
    <view class="search-section">
      <view class="search-input-wrapper">
        <input 
          class="search-input" 
          placeholder="æœç´¢è®¢å•å·ã€å–ä»¶ç æˆ–æ”¶ä»¶äºº" 
          value="{{searchKeyword}}" 
          bindinput="onSearchInput"
        />
        <view class="search-actions">
          <text class="search-btn" bindtap="onSearch">æœç´¢</text>
          <text 
            class="clear-btn" 
            bindtap="onClearSearch" 
            wx:if="{{searchKeyword}}"
          >Ã—</text>
        </view>
      </view>
    </view>

    <!-- çŠ¶æ€ç­›é€‰ -->
    <view class="filter-section">
      <view 
        wx:for="{{statusOptions}}" 
        wx:key="value"
        data-status="{{item.value}}"
        class="filter-item {{currentStatus === item.value ? 'active' : ''}}"
        bindtap="onStatusChange"
      >
        {{item.text}}
      </view>
    </view>

    <view class="order-list">
      <view 
        class="order-item" 
        wx:for="{{orders}}" 
        wx:key="id"
        data-pick-code="{{item.pickCode}}"
        data-status="{{item.status}}"
        bindtap="onOrderTap"
      >
        <view class="order-header">
          <view class="order-company">{{item.expressCompany || 'é¡ºä¸°é€Ÿè¿'}}</view>
          <view class="order-status status-{{item.status}}">
            {{item.status === 0 ? 'å¾…å–ä»¶' : item.status === 1 ? 'å·²å–ä»¶' : 'å·²è¿‡æœŸ'}}
          </view>
        </view>

        <view class="order-content">
          <view class="order-row">
            <text class="label">å¿«é€’å•å·ï¼š</text>
            <text class="value">{{item.orderNo || item.expressNumber || 'æ— '}}</text>
          </view>
          <view class="order-row">
            <text class="label">æ”¶ä»¶äººï¼š</text>
            <text class="value">{{item.receiverName || 'æ— '}}</text>
          </view>
          <view class="order-row">
            <text class="label">å¿«é€’æŸœï¼š</text>
            <text class="value">å¿«é€’æŸœ {{item.cabinetId || 'æ— '}}</text>
          </view>
          <view class="order-row">
            <text class="label">æ ¼å£ï¼š</text>
            <text class="value">{{item.compartmentNo || item.compartmentId || 'æ— '}}</text>
          </view>
          <view class="order-row">
            <text class="label">å­˜å…¥æ—¶é—´ï¼š</text>
            <text class="value">{{item.putInTime || item.createdAt || 'æ— '}}</text>
          </view>
        </view>

        <view class="order-footer">
          <view class="pick-code">
            <text class="pick-code-label">å–ä»¶ç ï¼š</text>
            <text class="pick-code-value">{{item.pickCode}}</text>
          </view>
          
          <view class="order-actions">
          <button class="btn-pickup" catchtap="onPickUp" data-pick-code="{{item.pickCode}}">æ‰“å¼€ä»“é—¨</button>
          <button class="btn-face" catchtap="handleFaceRecognition" data-pick-code="{{item.pickCode}}">äººè„¸è¯†åˆ«</button>
          <button class="btn-delete" catchtap="deleteOrder" data-order-id="{{item.id}}">åˆ é™¤è®¢å•</button>
        </view>
        </view>
      </view>

      <view wx:if="{{orders.length === 0 && !loading}}" class="empty">
        <text class="empty-icon">ğŸ“¦</text>
        <text class="empty-text">æš‚æ— è®¢å•</text>
        <button class="btn-pickup" bindtap="goToPickUp">å»å–ä»¶</button>
      </view>
    </view>
  </view>
</scroll-view>
